
# ğŸš€ Apexè™šæ‹Ÿç±»ã€æŠ½è±¡ç±»ä¸æ¥å£

---

## ğŸ§© ä¸€ã€Virtual Classï¼ˆè™šæ‹Ÿç±»ï¼‰

### ğŸ’¡ æ¦‚å¿µ

* `virtual` ç±»è¡¨ç¤ºâ€œå¯ä»¥ç»§æ‰¿çš„æ™®é€šç±»â€ã€‚
* å®ƒè‡ªå·±èƒ½ç”¨ï¼Œä¹Ÿå…è®¸åˆ«äººæ”¹é€ ã€‚
* ç±»ä¸­æ ‡è®°ä¸º `virtual` çš„æ–¹æ³•å¯ä»¥è¢«å­ç±» `override`ã€‚

---

### ğŸ§  ç”Ÿæ´»æ¯”å–»

æƒ³è±¡ä½ å¼€äº†ä¸€å®¶â€œå¤–å–å…¬å¸â€ï¼š

* å…¬å¸æä¾›ä¸€ä¸ª**é€šç”¨é…é€å‘˜æ¨¡æ¿ï¼ˆVirtual Classï¼‰**ã€‚
* æ™®é€šå‘˜å·¥å¯ä»¥ç›´æ¥ç”¨ï¼Œä¹Ÿå¯ä»¥è®©åˆ†å…¬å¸â€œè‡ªå®šä¹‰é…é€é€»è¾‘â€ã€‚

---

### âœ… ç¤ºä¾‹ï¼šé€šç”¨è®¢å•å¤„ç†å™¨

```apex
public virtual class OrderProcessor {
    public String orderId { get; set; }

    public OrderProcessor(String id) {
        this.orderId = id;
    }

    // virtual è¡¨ç¤ºå…è®¸å­ç±»ä¿®æ”¹å®ç°
    public virtual void processOrder() {
        System.debug('ğŸ§¾ æ­£åœ¨å¤„ç†è®¢å•ï¼š' + orderId);
    }

    public void confirmDelivery() {
        System.debug('âœ… è®¢å• ' + orderId + ' å·²é€è¾¾');
    }
}
```

#### å­ç±»ï¼šä¸åŒæ¸ é“è‡ªå®šä¹‰è®¢å•é€»è¾‘

```apex
public class OnlineOrderProcessor extends OrderProcessor {
    public OnlineOrderProcessor(String id) {
        super(id);
    }

    public override void processOrder() {
        System.debug('ğŸ’» æ­£åœ¨å¤„ç†çº¿ä¸Šè®¢å•ï¼š' + orderId);
    }
}

public class StoreOrderProcessor extends OrderProcessor {
    public StoreOrderProcessor(String id) {
        super(id);
    }

    public override void processOrder() {
        System.debug('ğŸª æ­£åœ¨å¤„ç†é—¨åº—è®¢å•ï¼š' + orderId);
    }
}
```

#### è°ƒç”¨ï¼š

```apex
List<OrderProcessor> orders = new List<OrderProcessor>{
    new OnlineOrderProcessor('O-1001'),
    new StoreOrderProcessor('S-2002')
};

for (OrderProcessor o : orders) {
    o.processOrder();
    o.confirmDelivery();
}
```

è¾“å‡ºï¼š

```
ğŸ’» æ­£åœ¨å¤„ç†çº¿ä¸Šè®¢å•ï¼šO-1001
âœ… è®¢å• O-1001 å·²é€è¾¾
ğŸª æ­£åœ¨å¤„ç†é—¨åº—è®¢å•ï¼šS-2002
âœ… è®¢å• S-2002 å·²é€è¾¾
```

---

### ğŸ”¹ ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ Virtual Classï¼Ÿ

| åœºæ™¯                | è¯´æ˜                |
| ----------------- | ----------------- |
| 1ï¸âƒ£ å„åˆ†æ”¯é€»è¾‘å…±ç”¨ä¸€å¥—åŸºç¡€ç»“æ„ | ä¸åŒä¸šåŠ¡ç±»å‹çš„è®¢å•ã€æŠ¥å‘Šã€è®¡ç®—é€»è¾‘ |
| 2ï¸âƒ£ éœ€è¦å¯æ‰©å±•çš„â€œçˆ¶ç±»æ¨¡æ¿â€  | åœ¨ä¸åŒç¯å¢ƒä¸‹æ”¹å†™æ–¹æ³•        |
| 3ï¸âƒ£ æƒ³æ”¯æŒâ€œå¤šæ€è°ƒç”¨â€     | çˆ¶ç±»å¼•ç”¨æŒ‡å‘ä¸åŒå­ç±»å®ä¾‹      |

---

## ğŸ§© äºŒã€Abstract Classï¼ˆæŠ½è±¡ç±»ï¼‰

### ğŸ’¡ æ¦‚å¿µ

* **ä¸èƒ½å®ä¾‹åŒ–**ï¼Œåªèƒ½è¢«ç»§æ‰¿ã€‚
* å®šä¹‰â€œå¿…é¡»å®ç°çš„æ–¹æ³•â€ã€‚
* ä¸€éƒ¨åˆ†é€»è¾‘å¯ä»¥å†™åœ¨æŠ½è±¡ç±»ä¸­ï¼Œä¸€éƒ¨åˆ†ç•™ç»™å­ç±»å®ç°ã€‚

---

### ğŸ§  ç”Ÿæ´»æ¯”å–»

æŠ½è±¡ç±»å°±åƒæ˜¯**å…¬å¸åˆ¶åº¦æ‰‹å†Œ** ğŸ“˜ã€‚
å®ƒè§„å®šï¼šæ‰€æœ‰å‘˜å·¥éƒ½å¿…é¡»ä¼šåšæŸäº›äº‹ï¼ˆæ¯”å¦‚ç­¾åˆ°ã€æŠ¥å‘Šï¼‰ï¼Œ
ä½†å…·ä½“æ€ä¹ˆåšï¼Œç”±ä¸åŒå²—ä½ï¼ˆå­ç±»ï¼‰å†³å®šã€‚

---

### âœ… ç¤ºä¾‹ï¼šé€šçŸ¥å‘é€ç³»ç»Ÿ

```apex
public abstract class NotificationService {
    public String recipient { get; set; }

    public NotificationService(String r) {
        this.recipient = r;
    }

    // å·²å®ç°çš„å…¬å…±é€»è¾‘
    public void prepareMessage() {
        System.debug('ğŸ“¦ æ­£åœ¨å‡†å¤‡æ¶ˆæ¯...');
    }

    // æŠ½è±¡æ–¹æ³•ï¼šç”±å­ç±»å†³å®šå¦‚ä½•å‘é€
    public abstract void sendNotification(String message);
}
```

#### å­ç±»ï¼šå®ç°ä¸åŒçš„å‘é€æ¸ é“

```apex
public class EmailNotification extends NotificationService {
    public EmailNotification(String r) {
        super(r);
    }

    public override void sendNotification(String message) {
        System.debug('ğŸ“§ å‘ ' + recipient + ' å‘é€é‚®ä»¶ï¼š' + message);
    }
}

public class SmsNotification extends NotificationService {
    public SmsNotification(String r) {
        super(r);
    }

    public override void sendNotification(String message) {
        System.debug('ğŸ“± å‘ ' + recipient + ' å‘é€çŸ­ä¿¡ï¼š' + message);
    }
}
```

#### è°ƒç”¨ï¼š

```apex
List<NotificationService> notifiers = new List<NotificationService>{
    new EmailNotification('user@demo.com'),
    new SmsNotification('138-0000-0000')
};

for (NotificationService n : notifiers) {
    n.prepareMessage();
    n.sendNotification('æ‚¨çš„è®¢å•å·²å‘è´§');
}
```

---

### ğŸ”¹ ä½¿ç”¨åœºæ™¯ï¼š

| åœºæ™¯                | ç¤ºä¾‹           |
| ----------------- | ------------ |
| 1ï¸âƒ£ æƒ³å®šä¹‰ä¸€ä¸ªé€šç”¨å·¥ä½œæµç¨‹   | å¦‚é€šçŸ¥ã€å®¡æ‰¹ã€å¯¼å…¥å¯¼å‡ºç­‰ |
| 2ï¸âƒ£ å¼ºåˆ¶å­ç±»å®ç°ç‰¹å®šè¡Œä¸º    | ç¡®ä¿æ‰€æœ‰å®ç°ç±»ç»“æ„ç»Ÿä¸€  |
| 3ï¸âƒ£ æœ‰â€œéƒ¨åˆ†é€šç”¨é€»è¾‘â€éœ€è¦å¤ç”¨ | å¯åœ¨çˆ¶ç±»ä¸­å†™å…¬å…±éƒ¨åˆ†   |

---

## ğŸ§© ä¸‰ã€Interfaceï¼ˆæ¥å£ï¼‰

### ğŸ’¡ æ¦‚å¿µ

* **åªå®šä¹‰è§„åˆ™ï¼Œä¸å†™å®ç°ã€‚**
* ç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ã€‚
* æ¥å£ä¸­åªå…è®¸å®šä¹‰**æ–¹æ³•ç­¾å**ï¼ˆå£°æ˜ï¼‰ï¼Œä¸å…è®¸å†™é€»è¾‘ã€‚

---

### ğŸ§  ç”Ÿæ´»æ¯”å–»

æ¥å£å°±åƒâ€œåˆåŒ ğŸ“„â€ï¼š
å…¬å¸è§„å®šä½ å¿…é¡»èƒ½æä¾›æŸäº›åŠŸèƒ½ï¼Œä½†å…·ä½“æ€ä¹ˆå®ç°éšä½ ã€‚

---

### âœ… ç¤ºä¾‹ï¼šè®°å½•æ“ä½œæ ‡å‡†æ¥å£

```apex
public interface IRecordHandler {
    void createRecord();
    void deleteRecord();
}
```

#### ä¸åŒæ¨¡å—å®ç°æ¥å£ï¼š

```apex
public class AccountHandler implements IRecordHandler {
    public void createRecord() {
        System.debug('ğŸ¢ åˆ›å»º Account è®°å½•');
    }
    public void deleteRecord() {
        System.debug('ğŸ¢ åˆ é™¤ Account è®°å½•');
    }
}

public class ContactHandler implements IRecordHandler {
    public void createRecord() {
        System.debug('ğŸ‘¤ åˆ›å»º Contact è®°å½•');
    }
    public void deleteRecord() {
        System.debug('ğŸ‘¤ åˆ é™¤ Contact è®°å½•');
    }
}
```

#### è°ƒç”¨ï¼š

```apex
List<IRecordHandler> handlers = new List<IRecordHandler>{
    new AccountHandler(),
    new ContactHandler()
};

for (IRecordHandler h : handlers) {
    h.createRecord();
    h.deleteRecord();
}
```

è¾“å‡ºï¼š

```
ğŸ¢ åˆ›å»º Account è®°å½•
ğŸ¢ åˆ é™¤ Account è®°å½•
ğŸ‘¤ åˆ›å»º Contact è®°å½•
ğŸ‘¤ åˆ é™¤ Contact è®°å½•
```

---

### ğŸ”¹ ä½¿ç”¨åœºæ™¯ï¼š

| åœºæ™¯               | ç¤ºä¾‹                                   |
| ---------------- | ------------------------------------ |
| 1ï¸âƒ£ ä¸åŒæ¨¡å—éœ€è¦ç»Ÿä¸€æ¥å£   | å¦‚å„ç±» Trigger Handler å®ç°ç»Ÿä¸€ `execute()` |
| 2ï¸âƒ£ æƒ³å®ç°å¤šç»§æ‰¿       | ä¸€ä¸ªç±»å¯å®ç°å¤šä¸ªæ¥å£                           |
| 3ï¸âƒ£ æƒ³è§„èŒƒå®ç°å±‚ä¸è°ƒç”¨å±‚è§£è€¦ | Controller ä¾èµ–æ¥å£è€Œéå…·ä½“å®ç°                |

---

## ğŸ§± å››ã€ä¸‰è€…å·®å¼‚æ€»ç»“ï¼ˆé¡¹ç›®å®ç”¨è§†è§’ï¼‰

| ç‰¹å¾         | Virtual Class        | Abstract Class        | Interface                 |
| ---------- | -------------------- | --------------------- | ------------------------- |
| èƒ½å¦å®ä¾‹åŒ–      | âœ… å¯ä»¥                 | âŒ ä¸è¡Œ                  | âŒ ä¸è¡Œ                      |
| ä¸»è¦ç›®çš„       | å…è®¸æ‰©å±•                 | å®šä¹‰æ¨¡æ¿                  | ç»Ÿä¸€è§„èŒƒ                      |
| æ–¹æ³•         | å¯æœ‰é»˜è®¤å®ç°               | éƒ¨åˆ†æŠ½è±¡ï¼Œéƒ¨åˆ†å®ç°             | å…¨éƒ¨å£°æ˜                      |
| å±æ€§         | âœ… å¯å®šä¹‰                | âœ… å¯å®šä¹‰                 | âš ï¸ ä»…å¸¸é‡                    |
| ä½¿ç”¨å…³é”®è¯      | `virtual`, `extends` | `abstract`, `extends` | `interface`, `implements` |
| ä½“ç°çš„ OOP ç‰¹æ€§ | ç»§æ‰¿ + å¤šæ€              | æŠ½è±¡ + å¤šæ€               | æŠ½è±¡ + è§£è€¦                   |
| å¸¸è§åº”ç”¨       | Handler åŸºç±» / å·¥å…·ç±»     | Service æ¨¡æ¿ / æµç¨‹æ ‡å‡†     | Trigger Handler æ¥å£ / ç­–ç•¥æ¨¡å¼ |

---

## ğŸ§  äº”ã€ä¸‰è€…è”åˆå®æˆ˜ï¼šç»Ÿä¸€è§¦å‘å™¨å¤„ç†æ¨¡å‹

```apex
// æ¥å£ï¼šè§„å®šæ‰€æœ‰Handlerå¿…é¡»æœ‰execute()
public interface ITriggerHandler {
    void execute();
}

// æŠ½è±¡ç±»ï¼šå®šä¹‰åŸºç¡€ç»“æ„
public abstract class BaseHandler implements ITriggerHandler {
    public abstract void execute(); // è®©å­ç±»å®ç°
    public void logAction(String message) {
        System.debug('ğŸ§¾ Log: ' + message);
    }
}

// è™šæ‹Ÿç±»ï¼šæä¾›å¯æ‰©å±•çš„é»˜è®¤é€»è¾‘
public virtual class AccountHandler extends BaseHandler {
    public override void execute() {
        logAction('å¤„ç† Account æ•°æ®ä¸­...');
        System.debug('ğŸ¢ AccountHandler æ‰§è¡Œå®Œæ¯•');
    }
}

// å¦ä¸€ä¸ªå®ç°
public class ContactHandler extends BaseHandler {
    public override void execute() {
        logAction('å¤„ç† Contact æ•°æ®ä¸­...');
        System.debug('ğŸ‘¤ ContactHandler æ‰§è¡Œå®Œæ¯•');
    }
}
```

#### è°ƒç”¨ï¼š

```apex
List<ITriggerHandler> handlers = new List<ITriggerHandler>{
    new AccountHandler(),
    new ContactHandler()
};
for (ITriggerHandler h : handlers) {
    h.execute();
}
```

---

### ğŸ§© æ€»ç»“ä¸€å¥è¯è®°å¿†ï¼š

| ç±»å‹                 | ä¸€å¥è¯ç†è§£          |
| ------------------ | -------------- |
| **Virtual Class**  | â€œèƒ½ç›´æ¥ç”¨ï¼Œä¹Ÿèƒ½ç»§æ‰¿æ”¹ã€‚â€  |
| **Abstract Class** | â€œæˆ‘å®šè§„åˆ™ï¼Œä½ å¿…é¡»è¡¥å…¨ã€‚â€  |
| **Interface**      | â€œæˆ‘åªæè¦æ±‚ï¼Œä¸ç®¡æ€ä¹ˆåšã€‚â€ |

---

