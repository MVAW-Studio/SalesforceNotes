

# 🧱 Apex 面向对象三大特性详解

> —— 以「生活世界」类比「代码世界」

---

## 🧩 一、封装（Encapsulation）

### 💬 比喻：

想象一个「自动咖啡机」。
你只需要按按钮（接口），机器就帮你磨豆、加水、加热、出咖啡。
但你**不能直接碰**机器内部的泵或加热器。

👉 这就是“封装”：
**隐藏内部细节，只暴露必要的接口供外部使用。**

---

### 🧠 概念解释：

| 关键词       | 说明                                      |
| --------- | --------------------------------------- |
| **隐藏数据**  | 类的内部细节不对外公开                             |
| **访问修饰符** | 控制外部能不能看到某个变量或方法（如 `private`, `public`） |
| **安全访问**  | 通过 getter/setter 方法或属性控制访问方式            |

---

### ✅ 代码示例：

```apex
public class BankAccount {
    // 🔒 封装的核心：不让外部直接访问余额
    private Decimal balance;

    // ✅ 提供安全的对外方法
    public void deposit(Decimal amount) {
        if (amount > 0) {
            balance += amount;
        } else {
            System.debug('❌ 存款金额无效');
        }
    }

    public void withdraw(Decimal amount) {
        if (amount > 0 && amount <= balance) {
            balance -= amount;
        } else {
            System.debug('❌ 取款失败');
        }
    }

    // ✅ 提供只读访问余额的方法
    public Decimal getBalance() {
        return balance;
    }
}
```

### 🔹 调用：

```apex
BankAccount acc = new BankAccount();
acc.deposit(1000);
acc.withdraw(300);
System.debug('账户余额: ' + acc.getBalance()); // 输出 700
```

> 💡 外部不能直接修改 `balance`，只能通过安全方法操作，这就是“封装”。

---

### ⚙️ 对应现实：

| 现实世界    | Apex世界         |
| ------- | -------------- |
| 咖啡机内部结构 | 类的成员变量         |
| 按钮、显示屏  | 对外暴露的方法        |
| 使用说明书   | 封装的接口（get/set） |

---

## 🧩 二、继承（Inheritance）

### 💬 比喻：

比如你有一个「交通工具」的概念 🚗🚲✈️
汽车、自行车、飞机 都是交通工具的一种。
它们都有“启动”、“停止”等共性，但细节不同。

👉 在 Apex 中，我们可以让“子类”继承“父类”的功能，而不用重复写代码。

---

### 🧠 概念解释：

| 关键词               | 说明             |
| ----------------- | -------------- |
| **父类（基类）**        | 提供通用的属性和方法     |
| **子类（派生类）**       | 继承父类，并可添加自己的特性 |
| **关键字 `extends`** | 用于定义继承关系       |

---

### ✅ 代码示例：

```apex
// 🚗 父类
public virtual class Vehicle {
    public void start() {
        System.debug('🚗 交通工具开始运行');
    }

    public void stop() {
        System.debug('🛑 交通工具停止');
    }
}

// 🚙 子类
public class Car extends Vehicle {
    public void honk() {
        System.debug('📣 汽车鸣笛');
    }
}
```

### 🔹 调用：

```apex
Car myCar = new Car();
myCar.start(); // ✅ 继承自父类
myCar.honk();  // ✅ 自己的功能
myCar.stop();  // ✅ 继承自父类
```

---

### ⚙️ 对应现实：

| 现实世界                 | Apex世界  |
| -------------------- | ------- |
| “交通工具”是大类            | 父类      |
| “汽车”、“飞机”、“自行车”是具体实现 | 子类      |
| 都能“启动”和“停止”          | 继承的共性方法 |

---

### 💡 小结：

> 继承让我们**复用代码**，让系统更像一个真实的“层级结构”。
> 比如你写一个通用的 `sendNotification()`，
> 所有不同类型的通知类都能继承并扩展。

---

## 🧩 三、多态（Polymorphism）

### 💬 比喻：

“开交通工具”🚗
你只知道“这是个交通工具”，但它可能是车、自行车或飞机。
当你按“启动”按钮，不同的交通工具会表现出不同的行为。

👉 这就是“多态”：
**同一个接口，不同对象可以有不同表现。**

---

### 🧠 概念解释：

| 关键词                | 说明                    |
| ------------------ | --------------------- |
| **相同方法，不同行为**      | 子类可重写父类方法（方法名相同、逻辑不同） |
| **关键字 `override`** | 在子类中重写父类方法            |
| **多态调用**           | 通过父类引用调用子类对象的方法       |

---

### ✅ 代码示例：

```apex
public virtual class Vehicle {
    public virtual void start() {
        System.debug('🚗 交通工具启动');
    }
}

public class Car extends Vehicle {
    public override void start() {
        System.debug('🚙 汽车引擎启动');
    }
}

public class Bicycle extends Vehicle {
    public override void start() {
        System.debug('🚴 自行车踩踏板启动');
    }
}
```

### 🔹 调用：

```apex
Vehicle v1 = new Car();
Vehicle v2 = new Bicycle();

v1.start(); // 输出：🚙 汽车引擎启动
v2.start(); // 输出：🚴 自行车踩踏板启动
```

> 💡 虽然 `v1` 和 `v2` 都是 `Vehicle` 类型，但它们实际运行的是各自子类的方法，这就是 **多态**。

---

### ⚙️ 对应现实：

| 现实世界                | Apex世界                        |
| ------------------- | ----------------------------- |
| “打开”电器：电视、空调、风扇反应不同 | “调用 start()”：Car、Bicycle 实现不同 |
| 一样的动作，不一样的反应        | 一样的方法，不一样的逻辑                  |

---

## 🧩 四、三者关系总结

| 特性 | 关键词                          | 作用             | 比喻            |
| -- | ---------------------------- | -------------- | ------------- |
| 封装 | private / public / get / set | 隐藏内部数据，只提供安全接口 | 咖啡机按钮         |
| 继承 | extends                      | 复用父类功能         | “汽车”继承“交通工具”  |
| 多态 | override                     | 同接口多行为         | 不同交通工具的“启动”反应 |

---

## 🧩 五、综合示例 🌟

```apex
// 🚗 父类：交通工具
public virtual class Vehicle {
    private String brand;

    public Vehicle(String brandName) {
        brand = brandName;
    }

    public virtual void start() {
        System.debug(brand + ' 启动');
    }

    public void stop() {
        System.debug(brand + ' 停止');
    }
}

// 🚙 子类1：汽车
public class Car extends Vehicle {
    public Car(String brandName) {
        super(brandName);
    }
    public override void start() {
        System.debug('🚗 汽车引擎启动');
    }
}

// 🚴 子类2：自行车
public class Bicycle extends Vehicle {
    public Bicycle(String brandName) {
        super(brandName);
    }
    public override void start() {
        System.debug('🚴 自行车用脚启动');
    }
}
```

### 🔹 调用示例：

```apex
List<Vehicle> vehicles = new List<Vehicle>{
    new Car('Toyota'),
    new Bicycle('Giant')
};

for (Vehicle v : vehicles) {
    v.start(); // 每个对象按自己的方式启动（多态）
}
```

🧠 输出：

```
🚗 汽车引擎启动
🚴 自行车用脚启动
```

---

## 🧩 六、总结表格 🧭

| 特性 | Apex关键字                            | 实现方式       | 示例                                  |
| -- | ---------------------------------- | ---------- | ----------------------------------- |
| 封装 | `private`, `public`, `{get; set;}` | 隐藏内部变量     | `private Decimal balance;`          |
| 继承 | `extends`, `virtual`, `override`   | 复用父类逻辑     | `class Car extends Vehicle`         |
| 多态 | `virtual`, `override`              | 父类引用指向子类对象 | `Vehicle v = new Car(); v.start();` |

---

## 💡 最后一句话总结：

> * **封装** 让代码更安全。
> * **继承** 让代码更简洁。
> * **多态** 让代码更灵活。

就像现实世界一样：

> 咖啡机（封装）能安全工作，
> 不同型号的机器（继承）能共享结构，
> 按下“启动”（多态）后各自表现不同。

